use crate::{fp::Fp, fp12::Fp12, fp2::Fp2, fp6::Fp6};

const BLS_S: u8 = 2;
const BLS_K: u8 = 12;

// p = 5044125407647214251
const BLS_P: u64 = 0x4600_5555_5555_aaab;

// h3 = 2366356426548243601069753987687709088104621721678962410379583120840019275952471579477684846670499039076873213559162845121989217658133790336552276567078487633052653005423051750848782286407340332979263075575489766963251914185767058009683318020965829271737924625612375201545022326908440428522712877494557944965298566001441468676802477524234094954960009227631543471415676620753242466901942121887152806837594306028649150255258504417829961387165043999299071444887652375514277477719817175923289019181393803729926249507024121957184340179467502106891835144220611408665090353102353194448552304429530104218473070114105759487413726485729058069746063140422361472585604626055492939586602274983146215294625774144156395553405525711143696689756441298365274341189385646499074862712688473936093315628166094221735056483459332831845007196600723053356837526749543765815988577005929923802636375670820616189737737304893769679803809426304143627363860243558537831172903494450556755190448279875942974830469855835666815454271389438587399739607656399812689280234103023464545891697941661992848552456326290792224091557256350095392859243101357349751064730561345062266850238821755009430903520645523345000326783803935359711318798844368754833295302563158150573540616830138810935344206231367357992991289265295323280
const BLS_H3: [u64; 67] = [
    0x00000000006599e3,
    0xc0943b2ec7fe6f8e,
    0x055bf1ceb531c801,
    0x5e8cc56370b0dbc7,
    0xd9caca9a9b7a9d03,
    0x3900aad88c6ffc3b,
    0xb99b0e48ebc3cd2b,
    0xbe49b1ea32254019,
    0x2220bb7fa28ebb66,
    0xc23e0daf864f0493,
    0xaeb79d2306a3f703,
    0x37d690b357f0fd44,
    0x87513bb3f4c4ac99,
    0x05c4f19574e17fd8,
    0x8ff600f4969bbbdb,
    0x281c33e10ca41c51,
    0x6335329f3431488b,
    0xa65b952740e43cb4,
    0xe7f32ed091e57c99,
    0x327e6332e06099cd,
    0x2121b3d1e7610f23,
    0x96dd6746c5e4f067,
    0xb4c4d044cf835ab6,
    0x34e9ca87a8d98b37,
    0x0e8f779e2bd7e153,
    0xe9731326096afbd7,
    0x13d1435515ab6558,
    0xab45867ebf46aa43,
    0x91c026800736d14c,
    0x385a9c84a9444e93,
    0x1de20f234a2a118c,
    0x945d4a8ba4f85b53,
    0xc310ec5cc14ea458,
    0xc2268785ce72851c,
    0x0759aac8c48fbd2c,
    0x2329b95b86ced356,
    0x431a491a95f3845b,
    0x1e865e016cd3156e,
    0xdb79274eadd0ffd1,
    0xdb722cc66ce608fa,
    0x44a2bcae344ed4a1,
    0xb300a67bd84cc161,
    0x29fbc1c43129d630,
    0xa73b38aef926df42,
    0xf6f20eecac11e68e,
    0x89bdab83394f5a3e,
    0x32f85b72c2198a1d,
    0x688ae2998ddc3039,
    0x77b660b3c1be9043,
    0xcbf432a41a99402a,
    0xc76387e254115ee7,
    0x6383adb002641f81,
    0x585ea0511d9071fb,
    0x0bf1a9a0e0dc17d8,
    0x332adf888789c9ab,
    0x109bfb1d8f19cca1,
    0xd7776d741038b8b9,
    0xfa83f9aee3a1e2fe,
    0xf61b8311daf0e113,
    0x7ecc469da45142f7,
    0x1cf6d2e64e2369f3,
    0xfa878508ee8c01df,
    0xb4e3edf3b6d981e4,
    0xa1ff5106cc993333,
    0xa28f8b5d2ddedfe3,
    0x8698e3308f7b2a5f,
    0x7bdfa56c6f35f090,
];

const BLS_LAMBDA: [u64; 6] = [
    0x1a0111ea397fe69a,
    0x4b1ba7b6434bacd7,
    0x64774b84f38512bf,
    0x6730d2a0f6b0f624,
    0x1eabfffeb1540000,
    0x8c0000000000aaab,
];

const COEFFS_27TH_ROOT: [Fp; 12] = [
    Fp([
        0x10f6_f41b_468b_cf87,
        0x9fb9_6ccd_599f_fc30,
        0xb4ae_8194_dd7e_fb65,
        0xfd01_e4bd_4083_2fed,
        0xcd41_56cf_3a0f_efab,
        0x982c_6740_e7ed_f2cd,
    ]),
    Fp([
        0x0d7a_239f_903e_c63f,
        0x697a_66ef_bda2_1c56,
        0x0401_68d6_b1fb_4342,
        0xb66f_892f_a130_224c,
        0xa3a5_81f7_e564_876e,
        0x81fc_7694_73bd_85f7,
    ]),
    Fp([
        0x0253_e2e2_c93b_5511,
        0xdf24_7ce0_0a70_5ed5,
        0x506e_c40d_cf3e_2971,
        0xd0f0_c5b4_36a3_56db,
        0xd22e_3deb_a7b2_184d,
        0x6661_6181_0998_96f7,
    ]),
    Fp([
        0x03d9_75b3_6aaf_2e81,
        0x0ace_ec99_2bcf_b2b9,
        0x217b_f843_b186_3214,
        0x6d54_0b52_10b0_6307,
        0x824c_fcbf_76d4_2c4d,
        0x6a65_0edb_e934_5d0a,
    ]),
    Fp([
        0x0329_9b39_cd50_cd55,
        0x4a44_7121_028d_b683,
        0xb341_ae1a_9044_b1bb,
        0x0c2e_2b23_dfbe_dd1c,
        0x6656_1a1e_dc9e_f823,
        0xc129_4563_2d5f_1677,
    ]),
    Fp([
        0x0307_f9cd_4ed9_168d,
        0xa147_a20a_be8b_a293,
        0xaf90_ef6a_914a_dc99,
        0x2fdd_70b4_24e1_b2a2,
        0xa57d_b912_3be5_2fad,
        0x74a0_8331_2987_5f72,
    ]),
    Fp([
        0x002a_ece6_4f92_e438,
        0x928a_f203_e32f_7556,
        0xb1f2_e9f7_bb2f_4aba,
        0xf36d_b24f_72e6_5519,
        0x3663_1c89_fa6c_6a92,
        0x301e_a12f_bd37_1ffc,
    ]),
    Fp([
        0x146e_b2f7_201f_14c8,
        0xf836_b147_4d99_486c,
        0x7857_2c83_b595_70a8,
        0xeb3e_9f79_2ebf_8147,
        0x61cb_b8fc_519e_00b2,
        0x4467_612e_d9a0_b71d,
    ]),
    Fp([
        0x0fd5_a632_6241_511e,
        0xb3d1_1db0_4e54_0a77,
        0x8470_e309_9eb9_5b15,
        0x8e5e_24ae_4b4a_f029,
        0xf890_b0b0_025b_30fa,
        0x6def_2091_de4c_3daa,
    ]),
    Fp([
        0x02d5_7a27_d040_5489,
        0x3441_e6c0_ddd6_fd65,
        0x70b2_50e6_40f6_2e25,
        0xe06f_d45c_a115_2673,
        0x3e8e_32d8_430c_1fa2,
        0x350a_5913_850f_7b26,
    ]),
    Fp([
        0x0fed_fce9_0768_13a3,
        0x0917_ecca_858d_0086,
        0x9112_ac38_cfe5_1858,
        0xc601_4c9c_ae70_acfb,
        0x5941_6249_d441_3771,
        0x36c0_b31d_625a_5a89,
    ]),
    Fp([
        0x1033_41bc_eb3a_c0d1,
        0xbce4_248f_fb92_b258,
        0xa20f_ba1e_2cc2_629c,
        0x5f19_1735_dbdb_d30b,
        0xa9b4_abb2_6fb0_a8b1,
        0xb45d_3cb2_b9df_54ed,
    ]),
];

/// 27th root of Fp12
/// 2215832431738254021858430833473491971472907921681848639066176995827469549541336756374498109335286165907308496272036*u^11 + 1568830231290002655414696898990994515906754827216931272303146338935885249207435695220858508099237158006327999983721*u^10 + 2789190503201674451857891076016074209873756838728155128589046353191958032604279347727174717406170552051958929605662*u^9 + 2766757639517403038926022128169213511408030714287506907840740953445619999258272434055733105667304591457836852294939*u^8 + 1899290885966997915932727775886289454766769693831016185819397553336201976561994577812375445396848740716768661066906*u^7 + 2730521554304824852333211249086101430803514712548201970920079722904463249643031119531359650834655731163153266539482*u^6 + 2372335291936719397558586286573991991990943761742261105882728734115101996471396939598874216892270954654873982192915*u^5 + 2647761599626775211506645008910551257291866501828740380582086965940927532121673610525201471087360012327636080951779*u^4 + 389437429987139622466189702971416088270898314622679253440470651889296222661007011295568998742161246291242055447985*u^3 + 952087828372006056375175265475346405803455327684867402998952995038578055919629631662111846585901856698458366123906*u^2 + 110700656196224825338140726992030708352686271264597717261216695317674463693221521918984355795975394087767305652271*u + 1587876598240339177559172903511792795433185889988342843144628184734599371629235594140230491168556177222480807631015
pub const W27: Fp12 = Fp12 {
    c0: Fp6 {
        c0: Fp2 {
            c0: COEFFS_27TH_ROOT[0],
            c1: COEFFS_27TH_ROOT[2],
        },
        c1: Fp2 {
            c0: COEFFS_27TH_ROOT[4],
            c1: COEFFS_27TH_ROOT[6],
        },
        c2: Fp2 {
            c0: COEFFS_27TH_ROOT[8],
            c1: COEFFS_27TH_ROOT[10],
        },
    },
    c1: Fp6 {
        c0: Fp2 {
            c0: COEFFS_27TH_ROOT[1],
            c1: COEFFS_27TH_ROOT[3],
        },
        c1: Fp2 {
            c0: COEFFS_27TH_ROOT[5],
            c1: COEFFS_27TH_ROOT[7],
        },
        c2: Fp2 {
            c0: COEFFS_27TH_ROOT[9],
            c1: COEFFS_27TH_ROOT[11],
        },
    },
};

pub const WP: Fp12 = Fp12 {
    c0: Fp6 {
        c0: Fp2 {
            c0: Fp([
                0x048fd3da7e6bff25,
                0x579b2d13725fab21,
                0x22a0636bba43ca4c,
                0x899380ca15caff7f,
                0x097d8788dd84085f,
                0x4068bfb0ba6c60d4,
            ]),
            c1: Fp::zero(),
        },
        c1: Fp2::zero(),
        c2: Fp2::zero(),
    },
    c1: Fp6::zero(),
};

// (q^k - 1)/(gcd(3, q^k - 1)) for checking if a field element in Fp12 has a 27th root
const HAS_27TH_ROOT_EXP: [u64; 72] = [
    0x0000000000713a91,
    0x7ede2bd1095d5c4a,
    0x3ba6a646860b4bd9,
    0x136846fde9ab4bb1,
    0x2b27746308c5cc35,
    0x5c29f2b22bbbf0ac,
    0x31f5a7f0678f800d,
    0x71e631efc41fe1ac,
    0x303159aca27dc7a8,
    0xa2bede9feeb424cf,
    0x402669682179b329,
    0x1820df99020f31ad,
    0x80271bd78fe70821,
    0x1ec321f212b61e5f,
    0x1018c3b2c9f65748,
    0xc2125611f8c41898,
    0x0df9dd5d14aeaf3e,
    0x0c011995bbd2382d,
    0x631877e192ee5990,
    0xdeaacafe1e8d5d5b,
    0xbd421fa96d51d326,
    0x76ba1e2bffa76142,
    0x2fd6d0d0de38f9e6,
    0xe4d8c44d3544a2f8,
    0xb3bb7f6ae43bbaa0,
    0xbd398cf79ddf9022,
    0x23abfd5966b17711,
    0x3148c447fe65c0a0,
    0xfd669549adc74650,
    0xaa88e9ef6497eae1,
    0xe7a35740f4d57330,
    0x949efd7cbfa089da,
    0xaa1413c5ce3fbbe7,
    0x6c756380cd6c8d64,
    0x9cf41f4fdbe1f211,
    0x19dc1b482a4cd100,
    0xe152f8bdaf8aa6ea,
    0x5fdd9aea2415c2b2,
    0x6550450fffc047a8,
    0xaa41a31a9897e6a9,
    0xf6c02beb9ac81951,
    0xe28eb0b3e143fee5,
    0x3f72fc97abf0e803,
    0x994e936c6569478a,
    0x40db4ff7584076a8,
    0xba186f9a10a0910e,
    0x4c5108282bf94015,
    0x4a72fd9e0b17a18f,
    0xcd443ede7a9ca099,
    0xb6a640ee355f6388,
    0x97f8ab0e3bccb6c9,
    0x076dcc348920288a,
    0xeb3f50f1f0625e07,
    0x8ec84e5d427523fd,
    0xee8f73d5b551fd96,
    0x1ca48c80409560a2,
    0xa6bb2d19506e674b,
    0xd1cc777f59fcc581,
    0x632e45a026ce2798,
    0x868bc704aad9b7ac,
    0xfb05fbf5af355964,
    0x95e878ea1561e23e,
    0xe2b42f0535374732,
    0x5108809d45a1a1ac,
    0xddf0fae6bf2f08ca,
    0xe3ae2a1d637e74ad,
    0x55295e79ce9e40c3,
    0x8c50aca42377b1ab,
    0x796d0e6154ae16ac,
    0x4f51ed5b2826c043,
    0x9be5f62006992eca,
    0x76426c371f51d1b0,
];

// (q^k - 1)/(gcd(p, q^k - 1)) for checking if a field element in Fp12 has a pth root
const HAS_P_ROOT_EXP: [u64; 71] = [
    0x0000000004da4226,
    0x095724c2ef911566,
    0x326ac0491276a157,
    0xe5efe09927c3051a,
    0x7ad129d1a3ae5f6b,
    0x8cb36b5a56bd3237,
    0x93f3486c47843429,
    0x5fc40bdaa7ba2646,
    0xdb3b3d43dcd5845f,
    0x37e22421f9e5e41f,
    0xb374e42c65484d82,
    0x618b34e1ba582df5,
    0xedb35758c266e8f6,
    0x20bbb0cbf1aac576,
    0x37edbf429b265de3,
    0x573e937a25088c68,
    0xdea9ae71cd1bf777,
    0x598eb5d30c2dd978,
    0x2aad75551a15faf4,
    0x14c616d8df2ff7d8,
    0x663a367c16617c38,
    0x2b698ef4da9bedd1,
    0xb4dceb2c055e062d,
    0x96709bb71fe183f4,
    0x8cc6f1d7167586a7,
    0xc79ea6bfbcf29e72,
    0xd6d4f0e6c7da2525,
    0x8e3c7e38b74acb8f,
    0xed35c68ac15a3411,
    0x2d1902f47ff57d57,
    0x1ee6ee48c2f36aaf,
    0x3f0c285ab2c74bcb,
    0xebe514a259075d27,
    0x8df337f90a8ea46b,
    0x66b14c4b464e40d5,
    0x47d3063ba769087d,
    0x0ddca9a592afcbd3,
    0xf0b4bf9fe1115896,
    0x95d32848aa727edd,
    0x8f08f6741a4cbde5,
    0xaec674baafacd5fb,
    0x1caf7dd8e02ad59b,
    0xc905c36850ce49fb,
    0xcc0197e1f8b8a250,
    0xc4e21b12c33cf5a1,
    0xc708df2bdfd24580,
    0xede244eb6f909959,
    0xfd6cc3d60d8143fd,
    0xccfaa04e771af56d,
    0xc1fcdf0e1e305a73,
    0x079e783e5e40368c,
    0xdbf945f28ca7fd33,
    0x61a6929793841841,
    0xcb05de0bf1bc42f0,
    0xb81deace53624411,
    0x31bb206982e95b70,
    0x604d7f1a29f85c97,
    0x5591517a4b651fb0,
    0x68b4f036ddce02a2,
    0x96610aafa66f3050,
    0x7742aea2e96fa2c6,
    0x141df64be039bd11,
    0x4c9f1ade0d25136c,
    0xf1d710ac328439a7,
    0xb3921c77b1ff9e5d,
    0x58a630a970aa4c16,
    0x236bf33da7b4a560,
    0x8bf14557600a9451,
    0x8528a46cf56fd582,
    0x2f489ae3fa8be672,
    0x55e6133fbab05f30,
];

// pub(crate) fn pth_root_inverse()
